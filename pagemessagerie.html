<!DOCTYPE html>
<html>
    <head>
        <title>Messagerie</title>
		<link rel="stylesheet" type="text/css" href="CSS/pagemessagerie.css">
    </head>
    <body>
		<nav id="menu">
			<ul>
				<li><a href="pageaccueil.html">Accueil</a></li>
				<li><a href="monprofil.php">Profil</a></li>
				<li><a href="pagederecherchepseudo.html">Recherche</a></li>
				<li><a href="#">Deconnexion</a></li>
			</ul>
		</nav>
        <h1>Voici les récents utilisateurs avec lesquels vous avez échangé</h1>
        <div id="utilisateurs">
        </div>
        <script>
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var utilisateurs = JSON.parse(this.responseText);
                    console.log(utilisateurs);
                    var divUtilisateurs = document.getElementById('utilisateurs');
                    
                    utilisateurs.forEach(function(utilisateur) {
                        var divUtilisateur = document.createElement('div');
                        divUtilisateur.innerHTML = `
                            <a href="conversation.html?user=${encodeURIComponent(utilisateur)}">${utilisateur}</a>
                        `;
                        divUtilisateurs.appendChild(divUtilisateur);
                    });
                }
            };
            xhr.open("GET", "echangesutilisateurs.php", true);
            xhr.send();
        </script>
    </body>
</html>
