<!DOCTYPE html>
<html>
<head>
    <title>Visites</title>
	<link rel="stylesheet" type="text/css" href="CSS/pagevisites.css">
</head>
<body>
	<nav id="menu">
		<ul>
			<li><a href="pageaccueil.html">Accueil</a></li>
			<li><a href="monprofil.php">Profil</a></li>
			<li><a href="pagemessagerie.html">Messagerie</a></li>
			<li><a href="deconnexion.php">Deconnexion</a></li>
		</ul>
	</nav>
	
    <h1>Curieux de savoir si vous avez du succès ?</h1>
	
	<h2>Voici la liste de ceux qui ont visiter ton profil :</h2>
    <div id="visitorsList"></div>
	
    <script>
        // Fonction pour charger la liste des visiteurs
        function loadVisitors() {
            // Création de l'objet XMLHttpRequest
            var xhr = new XMLHttpRequest();

            // Spécification de la requête
            xhr.open('GET', 'obtenirvisiteurs.php?Pseudo=' + encodeURIComponent, true);

            // Définition de la fonction de rappel
            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    // Conversion de la réponse JSON en objet JavaScript
                    var visitors = JSON.parse(xhr.responseText);
                    console.log(visitors);

                    // Sélection de l'élément HTML où afficher la liste
                    var visitorsList = document.getElementById('visitorsList');

                    // Construction de la liste des visiteurs
                    var html = '<ul>';
                    visitors.forEach(function(visitor) {
                        html += '<li>' + visitor + '</li>';
                    });
                    html += '</ul>';

                    // Affichage de la liste des visiteurs dans l'élément HTML
                    visitorsList.innerHTML = html;
                } else {
                    console.error('La requête a échoué : ' + xhr.status);
                }
            };

            // Gestion des erreurs
            xhr.onerror = function() {
                console.error('Erreur lors de la requête.');
            };

            // Envoi de la requête
            xhr.send();
        }

        // Appel de la fonction pour charger la liste des visiteurs au chargement de la page
        document.addEventListener('DOMContentLoaded', loadVisitors);
    </script>
</body>
</html>
